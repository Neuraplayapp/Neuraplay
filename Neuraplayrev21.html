<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neuraplay - The Synaptic Revolution</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .page-container { width: 100%; min-height: 100vh; }
        /* Smoother Page Transitions */
        .page-enter { opacity: 0; transform: translateY(10px); }
        .page-enter-active { opacity: 1; transform: translateY(0); transition: opacity 300ms ease-out, transform 300ms ease-out; }
        .page-exit { opacity: 1; transform: translateY(0); }
        .page-exit-active { opacity: 0; transform: translateY(10px); transition: opacity 300ms ease-in, transform 300ms ease-in; }
        
        @keyframes bounce-in { 0% { opacity: 0; transform: translateY(50px) scale(0.95); } 70% { opacity: 1; transform: translateY(-10px) scale(1.05); } 100% { opacity: 1; transform: translateY(0) scale(1); } }
        .animated-element { opacity: 0; }
        .animated-element.visible { animation: bounce-in 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
        .delay-1 { animation-delay: 0.1s; } .delay-2 { animation-delay: 0.2s; } .delay-3 { animation-delay: 0.3s; }
        
        /* Squishy Button Effect */
        .btn-squish { transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .btn-squish:active { transform: scale(0.95); transition-duration: 0.1s; }
        
        .clickable-bubble { display: block; text-decoration: none; color: inherit; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .clickable-bubble:hover { transform: translateY(-12px); box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.15); }
        .vote-btn:hover { transform: scale(1.2); }
        
        #side-panel-container { transition: transform 300ms ease-in-out; }
        #side-panel-container.closed { transform: translateX(100%); }
        #side-panel-container.open { transform: translateX(0); }
        
        .modal { display: none; }
        .modal.is-open { display: flex; }
        
        .feature-panel-container { position: relative; height: 24rem; /* 384px */ overflow: hidden; }
        .feature-panel { 
            position: absolute; 
            inset: 0;
            transform: translateX(-105%); 
            opacity: 0; 
            transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.6s ease-out; 
            pointer-events: none; 
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .feature-panel.active { 
            transform: translateX(0); 
            opacity: 1; 
            pointer-events: auto; 
        }

        #menu-toggle-btn {
            position: fixed;
            top: 100px;
            right: 0;
            transition: transform 300ms ease-in-out;
        }
        #menu-toggle-btn.hidden-by-panel {
            transform: translateX(100%);
        }

    </style>
</head>
<body class="bg-slate-50">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 border-b border-slate-200">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#home" class="nav-link text-3xl font-black text-violet-600 tracking-tighter">NEURAPLAY</a>
            <div class="hidden md:flex items-center space-x-8 font-semibold text-slate-600">
                <a href="#home" class="nav-link hover:text-violet-600 transition-colors">Home</a>
                <a href="#playground" class="nav-link hover:text-violet-600 transition-colors">The Playground</a>
                <a href="#forum" class="nav-link hover:text-violet-600 transition-colors">Community Forum</a>
            </div>
            <a href="#onboarding" class="nav-link btn-squish bg-violet-600 text-white font-bold px-6 py-3 rounded-full hover:bg-violet-700 transition-all duration-300 transform shadow-lg">
                Begin the Journey
            </a>
        </nav>
    </header>

    <main id="app-root"></main>

    <footer class="bg-slate-100 border-t border-slate-200 relative z-10">
        <div class="container mx-auto px-6 py-12">
             <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-slate-600">
                <div><h4 class="font-bold text-slate-800 mb-4">NEURAPLAY</h4><a href="#onboarding" class="nav-link block hover:text-violet-600">Begin Journey</a></div>
                <div><h4 class="font-bold text-slate-800 mb-4">Company</h4><a href="#about" id="about-us-link" class="nav-link text-left block hover:text-violet-600 mb-2">About Us</a><a href="#contact" id="contact-link" class="nav-link text-left block hover:text-violet-600">Contact</a></div>
                <div><h4 class="font-bold text-slate-800 mb-4">Community</h4><a href="#playground" class="nav-link block hover:text-violet-600 mb-2">The Playground</a><a href="#forum" class="nav-link block hover:text-violet-600">Forum</a></div>
                <div><h4 class="font-bold text-slate-800 mb-4">Legal</h4><button id="privacy-policy-link" class="text-left block hover:text-violet-600 mb-2">Privacy Policy</button><button id="tos-link" class="text-left block hover:text-violet-600">Terms of Service</button></div>
            </div>
            <div class="mt-12 border-t border-slate-200 pt-8 text-center text-slate-500">
                <a href="#help" id="help-link" class="nav-link font-semibold text-violet-600 hover:underline">Do you need help?</a>
                <p class="mt-4">© 2025 Neuraplay. All rights reserved. Engineering the future of consciousness.</p>
            </div>
        </div>
    </footer>

    <!-- TEMPLATES FOR EACH "PAGE" -->
    <template id="template-home">
        <div class="page-container">
            <section class="min-h-screen flex items-center justify-center text-center p-6">
                <div>
                    <h1 class="text-5xl md:text-8xl font-black text-slate-900 leading-tight tracking-tighter animated-element uppercase">Your Child is a Genius.</h1>
                    <p class="mt-8 text-xl md:text-2xl max-w-4xl mx-auto text-slate-600 animated-element delay-1">Unlock the potential.</p>
                    <div class="mt-12 animated-element delay-2"><a href="#onboarding" class="nav-link btn-squish inline-block bg-violet-600 text-white font-bold px-10 py-4 rounded-full hover:bg-violet-700 transition-all duration-300 transform shadow-2xl text-lg">Start the transformation</a></div>
                </div>
            </section>
            <section class="bg-white py-24 px-6">
                 <div class="container mx-auto text-center">
                    <!-- REVISED: Capitalization -->
                    <h2 class="text-4xl md:text-6xl font-bold text-slate-900 tracking-tight animated-element">An investment in their future is priceless.</h2>
                    <p class="mt-4 text-xl max-w-3xl mx-auto text-slate-500 animated-element delay-1">Seriously. For less than the cost of a single tutor session, you can provide a lifetime of advantage. Our experts have curated decades of science into one revolutionary psychoeducational tool.</p>
                </div>
            </section>
            <section class="bg-slate-50 py-24 px-6 overflow-hidden">
                <div class="container mx-auto grid md:grid-cols-2 gap-16 items-center">
                    <div class="animated-element">
                        <!-- REVISED: Capitalization -->
                        <h2 class="text-4xl md:text-5xl font-bold text-slate-900 tracking-tight">A whole new way to learn.</h2>
                        <div id="feature-nav" class="mt-8 space-y-4">
                            <button data-target="panel-1" class="feature-btn text-left w-full p-4 rounded-lg text-lg font-semibold bg-violet-600 text-white shadow-lg">Neuro-psychological teaching methods</button>
                            <button data-target="panel-2" class="feature-btn text-left w-full p-4 rounded-lg text-lg font-semibold bg-white border">Tailor-made for the learner</button>
                            <button data-target="panel-3" class="feature-btn text-left w-full p-4 rounded-lg text-lg font-semibold bg-white border">The Montessori approach</button>
                        </div>
                    </div>
                    <div class="feature-panel-container">
                        <div id="panel-1" class="feature-panel bg-white p-8 rounded-2xl shadow-2xl border active"><h3 class="font-bold text-2xl text-violet-600">Rooted in science</h3><p class="mt-4 text-slate-600">Every game, story, and challenge is built upon proven neuropsychological principles like CBT, IPT, and Family Therapy, adapted by experts to be engaging and effective for young minds.</p></div>
                        <div id="panel-2" class="feature-panel bg-white p-8 rounded-2xl shadow-2xl border"><h3 class="font-bold text-2xl text-violet-600">Uniquely personal</h3><p class="mt-4 text-slate-600">Our Synaptic AI™ analyzes your child's unique learning style and emotional responses to create a truly bespoke educational journey, ensuring they are always perfectly challenged and supported.</p></div>
                        <div id="panel-3" class="feature-panel bg-white p-8 rounded-2xl shadow-2xl border"><h3 class="font-bold text-2xl text-violet-600">Guided by wisdom</h3><p class="mt-4 text-slate-600">We embrace the Montessori philosophy of self-directed discovery. Our app provides the tools and the prepared environment; your child leads the way, fostering independence and a true love of learning.</p></div>
                    </div>
                </div>
            </section>
        </div>
    </template>

    <template id="template-playground">
        <div class="page-container bg-white pt-24 relative flex">
            <aside class="bg-slate-100 w-72 h-screen sticky top-24 p-6 border-r border-slate-200 flex-col hidden lg:flex">
                <div id="playground-dashboard-profile" class="text-center mb-6"></div>
                <nav id="playground-nav" class="space-y-2"></nav>
            </aside>
            <main class="flex-grow p-10">
                <div id="playground-view-container"></div>
            </main>
        </div>
    </template>
    
    <template id="template-onboarding">
        <div class="page-container bg-violet-600 text-white py-24 px-6">
            <div class="container mx-auto text-center">
                <!-- REVISED: Capitalization and wording -->
                <h1 class="text-5xl md:text-7xl font-black tracking-tighter animated-element">The best investment you ever will make is your child.</h1>
                <p class="mt-4 text-xl md:text-2xl max-w-3xl mx-auto text-violet-200 animated-element delay-1">Their education is priceless. Seriously.</p>
                <div class="mt-16 max-w-5xl mx-auto bg-white/10 backdrop-blur-lg p-10 rounded-3xl border border-white/20">
                    <h2 class="text-3xl font-bold mb-8 animated-element">What awaits you inside Neuraplay:</h2>
                    <div class="grid md:grid-cols-3 gap-8 text-left">
                        <div class="animated-element delay-1"><h3 class="font-bold text-xl mb-2">Expert-crafted psychoeducational tools</h3><p class="text-violet-200">Gain full access to our entire library of engaging, scientifically-informed games designed by a cross-functional team of psychologists, designers, and developers.</p></div>
                        <div class="animated-element delay-2"><h3 class="font-bold text-xl mb-2">The revolutionary Synaptic AI™</h3><p class="text-violet-200">Unlock the power of our proprietary AI, which provides personalized learning paths, adaptive difficulty, and a private parent dashboard with unparalleled insights.</p></div>
                        <div class="animated-element delay-3"><h3 class="font-bold text-xl mb-2">A thriving community</h3><p class="text-violet-200">Join our exclusive forum to share breakthroughs, ask questions, and grow alongside other forward-thinking families and our team of experts.</p></div>
                    </div>
                </div>
                <div class="mt-16 grid md:grid-cols-2 gap-8 max-w-2xl mx-auto">
                    <div class="animated-element delay-2"><h3 class="text-2xl font-bold">Ready to dive in?</h3><p class="mt-2 text-violet-200 mb-4">Explore our community for free and see what everyone is talking about.</p><a href="#forum" class="nav-link btn-squish inline-block bg-white/20 backdrop-blur-lg text-white font-bold px-10 py-4 rounded-full hover:bg-white/30 w-full">Explore the community forum</a></div>
                    <div class="animated-element delay-3"><h3 class="text-2xl font-bold">Ready to transform?</h3><p class="mt-2 text-violet-200 mb-4">$10 for your child's future is nothing. Unlock every feature now.</p><a href="#registration" class="nav-link btn-squish inline-block bg-white text-violet-600 font-bold px-10 py-4 rounded-full hover:bg-slate-200 w-full">Register & unlock full potential</a></div>
                </div>
            </div>
        </div>
    </template>

    <template id="template-registration">
        <div class="page-container bg-white py-24 px-6 flex items-center justify-center">
            <div id="registration-container" class="max-w-xl w-full">
                <!-- Step 1 will be injected here by JS -->
            </div>
        </div>
    </template>

    <template id="template-forum-registration">
        <div class="page-container bg-white py-24 px-6 flex items-center justify-center">
            <div class="max-w-xl w-full bg-slate-50 p-8 rounded-2xl border border-slate-200">
                <h2 class="text-3xl font-bold mb-1 text-center">Join the community forum</h2>
                <p class="text-center text-slate-500 mb-6">Create a free account to post, reply, and connect with others.</p>
                <div id="forum-reg-form" class="space-y-4">
                     <div>
                        <label class="font-bold">I am a...</label>
                        <div class="flex gap-4 mt-2">
                            <button data-role="learner" class="role-btn flex-1 p-3 rounded-lg border-2 border-slate-300">Learner</button>
                            <button data-role="parent" class="role-btn flex-1 p-3 rounded-lg border-2 border-slate-300">Parent</button>
                        </div>
                    </div>
                    <div id="forum-age-selector" class="hidden">
                        <label for="forum-reg-age" class="font-bold">Learner's Age</label>
                        <select id="forum-reg-age" class="w-full p-3 rounded-lg border border-slate-300 mt-2"><option value="4">3-5</option><option value="7">6-8</option><option value="10">9-12</option></select>
                    </div>
                    <input id="forum-reg-username" type="text" placeholder="Create a username" class="w-full p-3 rounded-lg border border-slate-300">
                    <input id="forum-reg-email" type="email" placeholder="Enter your email" class="w-full p-3 rounded-lg border border-slate-300">
                    <h4 class="font-bold pt-2">Choose your hero avatar</h4>
                    <div id="forum-reg-avatar-selection" class="flex flex-wrap gap-2 justify-center"></div>
                    <button id="forum-reg-submit" class="btn-squish w-full bg-violet-600 text-white font-bold py-3 rounded-full">Create free account</button>
                </div>
            </div>
        </div>
    </template>

    <template id="template-forum">
        <div class="page-container bg-white pt-24 relative overflow-x-hidden">
            <div id="side-panel-container" class="closed fixed top-0 right-0 h-full z-40">
                <aside id="side-panel" class="bg-slate-800 text-white w-64 h-full p-6 space-y-4 flex flex-col">
                    <h2 class="text-2xl font-bold">Dashboard</h2>
                    <nav class="flex-grow">
                        <a href="#" id="side-panel-home" class="flex items-center gap-3 py-2 px-3 rounded-lg hover:bg-slate-700"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>Home</a>
                        <a href="#" id="side-panel-profile" class="flex items-center gap-3 py-2 px-3 rounded-lg hover:bg-slate-700"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>User profile</a>
                        <a href="#" id="side-panel-parent-dashboard" class="flex items-center gap-3 py-2 px-3 rounded-lg hover:bg-slate-700 hidden"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2m14-2v-2a4 4 0 00-4-4h-1m-4-7h.01M12 3h.01M16 3h.01M21 3h.01M3 21h18M3 17h.01M3 13h.01M3 9h.01M3 5h.01"></path></svg>Parent dashboard</a>
                        <a href="#" id="side-panel-friends" class="flex items-center gap-3 py-2 px-3 rounded-lg hover:bg-slate-700"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.975 5.975 0 0112 13a5.975 5.975 0 013-1.197M15 21a9 9 0 01-6-3.79V15m12 6a9 9 0 00-6-3.79V15m0-3.354a4 4 0 110-5.292"></path></svg>Friends</a>
                    </nav>
                </aside>
            </div>
            <button id="menu-toggle-btn" class="fixed top-[100px] right-0 z-50 bg-violet-600/80 backdrop-blur-sm text-white p-2 pl-3 rounded-l-full shadow-lg transition-all duration-300 hover:scale-110"><div class="flex items-center gap-1"><span class="font-bold text-sm">Dashboard</span><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></div></button>
            <div id="forum-content-area" class="container mx-auto transition-all duration-300 px-6"><div id="forum-view-container"></div></div>
            <!-- Modals -->
            <div id="rules-modal" class="modal fixed inset-0 bg-black/60 backdrop-blur-sm items-center justify-center p-4 z-[60]"><div class="bg-white max-w-2xl w-full rounded-2xl p-8 shadow-2xl"><h2 class="text-2xl font-bold mb-4">Our community guidelines</h2><div class="text-slate-600 space-y-3 max-h-[60vh] overflow-y-auto pr-4"><p><strong>Be kind and respectful:</strong> Treat everyone with kindness. No bullying, name-calling, or making others feel bad. We are all here to learn and grow together.</p><p><strong>Keep it safe:</strong> Never share personal information like your full name, address, phone number, or school name. This is to protect you and everyone in our family.</p><p><strong>Stay on topic:</strong> Keep your posts related to the channel's theme. This helps everyone find what they are looking for.</p><p><strong>Parents, guide your children:</strong> We encourage parents to explore the forum with their children. Help them understand the rules and how to be a good digital citizen.</p><p><strong>No inappropriate content:</strong> Do not post anything scary, violent, or mean. This is a positive space for all ages.</p><p><strong>Report problems:</strong> If you see something that breaks the rules or makes you feel uncomfortable, please use the discrete report button on the post.</p></div><div class="mt-6 flex items-center"><input type="checkbox" id="rules-agree-checkbox" class="h-4 w-4 rounded"><label for="rules-agree-checkbox" class="ml-2 text-sm">I have read and agree to the community rules.</label></div><button id="close-rules-btn" class="btn-squish mt-4 w-full bg-violet-600 text-white font-bold py-2 rounded-full disabled:bg-slate-400" disabled>Let's go!</button></div></div>
            <div id="welcome-modal" class="modal fixed inset-0 bg-black/60 backdrop-blur-sm items-center justify-center p-4 z-[60]"><div class="bg-white max-w-lg w-full rounded-2xl p-8 shadow-2xl text-center"><h2 class="text-3xl font-bold mb-4 text-violet-600">Welcome!</h2><p class="text-slate-600 text-lg">YOU are now part of the loving Neuraplay family. Start exploring for yourself and show others the hero you already are inside!</p><button id="close-welcome-btn" class="btn-squish mt-6 w-full bg-violet-600 text-white font-bold py-2 rounded-full">Let's go!</button></div></div>
            <div id="login-required-modal" class="modal fixed inset-0 bg-black/60 backdrop-blur-sm items-center justify-center p-4 z-[60]"><div class="bg-white max-w-md w-full rounded-2xl p-8 shadow-2xl text-center"><h2 class="text-2xl font-bold mb-4">Action required</h2><p class="text-slate-500 mb-6">Please sign in to perform this action.</p><div class="flex flex-col gap-2"><button id="login-modal-signin" class="btn-squish w-full bg-violet-600 text-white font-bold py-2 rounded-full">Sign In</button><p class="text-sm">Don't have an account? <button id="login-modal-signup" class="text-violet-600 font-semibold hover:underline">Sign up!</button></p></div></div></div>
            <div id="tos-modal" class="modal fixed inset-0 bg-black/60 backdrop-blur-sm items-center justify-center p-4 z-[60]"></div>
            <div id="privacy-modal" class="modal fixed inset-0 bg-black/60 backdrop-blur-sm items-center justify-center p-4 z-[60]"></div>
        </div>
    </template>
    
    <template id="template-about">
        <div class="page-container bg-white py-24 px-6">
            <div class="container mx-auto max-w-4xl text-center">
                <h1 class="text-4xl md:text-6xl font-bold text-slate-900 tracking-tight">About Neuraplay</h1>
                <p class="mt-6 text-xl text-slate-600">We are a passionate team of world-class psychologists, educators, designers, and IT specialists united by a single mission: to unlock the latent potential in every child. We believe that learning shouldn't be a chore, but an exciting adventure. By fusing proven neuropsychological principles with captivating gameplay, we've created a revolutionary tool that nurtures not just knowledge, but the core cognitive skills essential for a successful future. Welcome to the synaptic revolution.</p>
            </div>
        </div>
    </template>

    <template id="template-contact">
        <div class="page-container bg-white py-24 px-6">
            <div class="container mx-auto max-w-2xl">
                <h1 class="text-4xl md:text-6xl font-bold text-slate-900 tracking-tight text-center">Get in touch</h1>
                <p class="mt-4 text-xl text-slate-500 text-center mb-12">Have a question, a suggestion, or just want to say hello? We'd love to hear from you.</p>
                <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
                    <div class="space-y-4">
                        <input type="text" placeholder="Your name" class="w-full p-3 rounded-lg border border-slate-300">
                        <input type="email" placeholder="Your email" class="w-full p-3 rounded-lg border border-slate-300">
                        <textarea placeholder="Your message..." rows="6" class="w-full p-3 rounded-lg border border-slate-300"></textarea>
                        <button class="btn-squish w-full bg-violet-600 text-white font-bold py-3 rounded-full">Send message</button>
                    </div>
                </div>
            </div>
        </div>
    </template>
    
    <template id="template-help">
        <div class="page-container bg-white py-24 px-6">
            <div class="container mx-auto max-w-2xl">
                <h1 class="text-4xl md:text-6xl font-bold text-slate-900 tracking-tight text-center">How can we help?</h1>
                <p class="mt-4 text-xl text-slate-500 text-center mb-12">Don't worry, everything is fine! Our support team is here to help you on your journey.</p>
                <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
                    <div class="space-y-4">
                        <input id="help-page-name" type="text" placeholder="Your name" class="w-full p-3 rounded-lg border border-slate-300">
                        <input id="help-page-account" type="text" placeholder="Your account name (if you have one)" class="w-full p-3 rounded-lg border border-slate-300">
                        <input id="help-page-subject" type="text" placeholder="Subject" class="w-full p-3 rounded-lg border border-slate-300">
                        <textarea id="help-page-problem" placeholder="Please describe the problem..." rows="4" class="w-full p-3 rounded-lg border border-slate-300"></textarea>
                    </div>
                    <div class="flex gap-4 mt-6">
                        <a id="submit-help-page-link" href="#" class="btn-squish text-center w-full bg-violet-600 text-white font-bold py-3 rounded-full">Send to support</a>
                    </div>
                </div>
            </div>
        </div>
    </template>


    <script>
        // --- State Management & Constants ---
        let currentUser = null; 
        let currentChannel = 'What I Learned Today';
        let channels = ["What I Learned Today", "Insights", "Amazing Discoveries", "Parenting Hacks", "Emotional Wins", "Cognitive Leaps", "Creative Sparks", "Ask the Experts", "Success Stories", "Resource Share"];
        const avatars = Array.from({length: 6}, (_, i) => `https://placehold.co/100x100/${['c084fc','7dd3fc','f472b6','fbbf24','4ade80','f87171'][i]}/ffffff?text=NP`);
        const routes = { 
            '#home': 'template-home', 
            '#playground': 'template-playground', 
            '#forum': 'template-forum', 
            '#onboarding': 'template-onboarding', 
            '#registration': 'template-registration',
            '#forum-registration': 'template-forum-registration',
            '#about': 'template-about',
            '#contact': 'template-contact',
            '#help': 'template-help',
        };
        let posts = [
            { id: 1, channel: 'What I Learned Today', title: 'My son finally understood sharing!', content: 'We used the "two baskets" game from the app, and something just clicked. He shared his toys without any prompting for the first time!', author: 'Sarah J.', votes: 15, avatar: 'https://placehold.co/100x100/c084fc/ffffff?text=S', replies: [
                { id: 101, parentId: 1, author: 'Mike R.', avatar: 'https://placehold.co/100x100/7dd3fc/ffffff?text=M', votes: 5, content: 'That\'s amazing! We are going to try that tonight.', replies: [] }
            ]},
            { id: 2, channel: 'Amazing Discoveries', title: 'The AI storyteller is incredible', content: 'It wove my daughter\'s favorite animal (a penguin) into a story about emotional regulation. She was captivated!', author: 'Mike R.', votes: 22, avatar: 'https://placehold.co/100x100/7dd3fc/ffffff?text=M', replies: [] },
        ];
        const journeyPrompts = [ "What is a superpower you wish you had and why?", "If you could build anything in the world, what would it be?", "Write about a time you felt really brave.", "What is your favorite memory and why does it make you happy?", "If your feelings were colors, what color are you today?", "Describe your dream adventure." ];
        const ranks = [
            { name: "New Learner", xpThreshold: 0, stars: 1 },
            { name: "Distinguished Learner", xpThreshold: 100, stars: 2 },
            { name: "Master Learner", xpThreshold: 300, stars: 3 },
            { name: "Superhero Learner", xpThreshold: 1000, stars: 4 }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const appRoot = document.getElementById('app-root');

            // --- Core Navigation & Page Rendering ---
            let animationObserver;
            function setupAnimationObserver(pageElement) {
                const elementsToAnimate = pageElement.querySelectorAll('.animated-element');
                if (!elementsToAnimate.length) return;
                animationObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
                }, { threshold: 0.1 });
                elementsToAnimate.forEach(el => animationObserver.observe(el));
            }

            function renderPage(templateId) {
                if (animationObserver) animationObserver.disconnect();
                const template = document.getElementById(templateId);
                if (!template) return;
                const newPage = template.content.cloneNode(true).firstElementChild;
                
                if (appRoot.firstChild) {
                    const oldPage = appRoot.firstChild;
                    oldPage.classList.add('page-exit', 'page-exit-active');
                    oldPage.addEventListener('transitionend', () => oldPage.remove(), { once: true });
                }

                newPage.classList.add('page-enter');
                appRoot.appendChild(newPage);
                requestAnimationFrame(() => {
                    newPage.classList.add('page-enter-active');
                    setupAnimationObserver(newPage);
                    if (templateId === 'template-forum') initializeForum();
                    if (templateId === 'template-playground') initializePlayground();
                    if (templateId === 'template-home') initializeHomePage();
                    if (templateId === 'template-registration') initializeRegistrationPage();
                    if (templateId === 'template-forum-registration') initializeForumRegistrationPage();
                    if (templateId === 'template-help') initializeHelpPage();
                });
                window.scrollTo(0, 0);
            }

            function navigate() {
                const path = window.location.hash || '#home';
                renderPage(routes[path] || routes['#home']);
            }
            
            function attachNavLinks() {
                 document.querySelectorAll('.nav-link').forEach(link => {
                    if (link.dataset.listenerAttached) return;
                    link.dataset.listenerAttached = true;

                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const path = new URL(link.href).hash;
                        if (window.location.hash !== path) {
                            window.history.pushState({}, '', path);
                            navigate();
                        }
                    });
                });
            }
            
            const observer = new MutationObserver(() => {
                attachNavLinks();
                attachGlobalFooterListeners();
            });
            observer.observe(document.body, { childList: true, subtree: true });

            window.addEventListener('popstate', navigate);
            navigate(); 

            // --- Home Page Logic ---
            function initializeHomePage() {
                const featureBtns = document.querySelectorAll('.feature-btn');
                const featurePanels = document.querySelectorAll('.feature-panel');

                featureBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        featureBtns.forEach(b => {
                            b.classList.remove('bg-violet-600', 'text-white', 'shadow-lg');
                            b.classList.add('bg-white', 'border');
                        });
                        btn.classList.add('bg-violet-600', 'text-white', 'shadow-lg');
                        btn.classList.remove('bg-white', 'border');
                        
                        const targetPanelId = btn.dataset.target;
                        featurePanels.forEach(panel => {
                            panel.classList.toggle('active', panel.id === targetPanelId);
                        });
                    });
                });
            }
            
            // --- Registration Page Logic (Paid) ---
            function initializeRegistrationPage() {
                const container = document.getElementById('registration-container');
                container.innerHTML = `
                    <div id="reg-step-1" class="reg-step bg-slate-50 p-8 rounded-2xl border border-slate-200">
                        <h2 class="text-3xl font-bold mb-1 text-center">Create your account</h2>
                        <p class="text-center text-slate-500 mb-6">You've taken the first step toward your best future!</p>
                        <div class="space-y-4">
                            <div>
                                <label class="font-bold">I am a...</label>
                                <div class="flex gap-4 mt-2">
                                    <button data-role="learner" class="role-btn flex-1 p-3 rounded-lg border-2 border-slate-300">Learner</button>
                                    <button data-role="parent" class="role-btn flex-1 p-3 rounded-lg border-2 border-slate-300">Parent</button>
                                </div>
                            </div>
                            <div id="age-selector" class="hidden">
                                <label for="reg-age" class="font-bold">Learner's age</label>
                                <select id="reg-age" class="w-full p-3 rounded-lg border border-slate-300 mt-2"><option value="4">3-5</option><option value="7">6-8</option><option value="10">9-12</option></select>
                            </div>
                            <input id="reg-username" type="text" placeholder="Create a username" class="w-full p-3 rounded-lg border border-slate-300">
                            <input id="reg-email" type="email" placeholder="Enter your email" class="w-full p-3 rounded-lg border border-slate-300">
                            <h4 class="font-bold pt-2">Choose your hero avatar</h4>
                            <div id="reg-avatar-selection" class="flex flex-wrap gap-2 justify-center"></div>
                            <div class="flex items-center pt-2"><input type="checkbox" id="reg-rules-agree" class="h-4 w-4 rounded"><label for="reg-rules-agree" class="ml-2 text-sm">I have read and agree to the <button id="reg-show-tos" class="text-violet-600 hover:underline">terms of service</button>.</label></div>
                            <button id="reg-step1-next" class="btn-squish w-full bg-violet-600 text-white font-bold py-3 rounded-full disabled:bg-slate-400" disabled>Next: Address & payment</button>
                        </div>
                    </div>
                    <div id="reg-step-2" class="reg-step hidden bg-slate-50 p-8 rounded-2xl border border-slate-200">
                         <h2 class="text-3xl font-bold mb-6 text-center">Billing information</h2>
                         <div class="space-y-4">
                            <input type="text" placeholder="Full name" class="w-full p-3 rounded-lg border">
                            <input type="text" placeholder="Address" class="w-full p-3 rounded-lg border">
                            <div class="grid grid-cols-2 gap-4">
                                <input type="text" placeholder="City" class="w-full p-3 rounded-lg border">
                                <input type="text" placeholder="Postal code" class="w-full p-3 rounded-lg border">
                            </div>
                            <div class="p-4 bg-violet-100 rounded-lg">
                                <h4 class="font-bold">Credit card information (Demo)</h4>
                                 <input type="text" placeholder="Card number (e.g., 4242 4242 4242 4242)" class="w-full p-3 mt-2 rounded-lg border">
                                 <div class="grid grid-cols-2 gap-4 mt-2">
                                    <input type="text" placeholder="MM/YY" class="w-full p-3 rounded-lg border">
                                    <input type="text" placeholder="CVC" class="w-full p-3 rounded-lg border">
                                 </div>
                            </div>
                            <button id="reg-step2-next" class="btn-squish w-full bg-violet-600 text-white font-bold py-3 rounded-full">Complete purchase ($10)</button>
                         </div>
                    </div>
                    <div id="reg-step-3" class="reg-step hidden text-center">
                        <h2 class="text-4xl font-bold text-green-500">Success!</h2>
                        <p class="text-xl mt-4 text-slate-600">Your journey begins now. Welcome to the family!</p>
                        <a href="#playground" class="nav-link btn-squish mt-8 inline-block bg-violet-600 text-white font-bold px-10 py-4 rounded-full">Go to the playground</a>
                    </div>
                `;
                
                let selectedRole = '';
                let selectedAvatar = avatars[0];
                const avatarContainer = container.querySelector('#reg-avatar-selection');
                avatarContainer.innerHTML = avatars.map(av => `<img src="${av}" class="w-16 h-16 rounded-full cursor-pointer hover:ring-2 ring-violet-500" data-avatar="${av}">`).join('');
                avatarContainer.querySelector('img').classList.add('ring-2', 'ring-violet-500');

                container.querySelectorAll('.role-btn').forEach(btn => {
                    btn.onclick = () => {
                        container.querySelector('.role-btn.bg-violet-600')?.classList.remove('bg-violet-600', 'text-white');
                        btn.classList.add('bg-violet-600', 'text-white');
                        selectedRole = btn.dataset.role;
                        document.getElementById('age-selector').classList.toggle('hidden', selectedRole !== 'learner');
                    }
                });

                avatarContainer.querySelectorAll('img').forEach(img => {
                    img.onclick = () => {
                        avatarContainer.querySelector('.ring-2')?.classList.remove('ring-2', 'ring-violet-500');
                        img.classList.add('ring-2', 'ring-violet-500');
                        selectedAvatar = img.dataset.avatar;
                    };
                });
                
                const step1NextBtn = document.getElementById('reg-step1-next');
                const agreeCheckbox = document.getElementById('reg-rules-agree');
                agreeCheckbox.onchange = () => { step1NextBtn.disabled = !agreeCheckbox.checked; };
                document.getElementById('reg-show-tos').onclick = (e) => { e.preventDefault(); showLegalModal('tos'); };
                
                step1NextBtn.onclick = () => {
                    const username = document.getElementById('reg-username').value.trim();
                    const email = document.getElementById('reg-email').value.trim();
                    const age = document.getElementById('reg-age').value;
                    if (!selectedRole) { alert('Please select if you are a Learner or a Parent.'); return; }
                    if (username && email && email.includes('@')) {
                        currentUser = { username, email, role: selectedRole, age: selectedRole === 'learner' ? parseInt(age) : null, profile: { about: '', avatar: selectedAvatar, rank: 'New Learner', xp: 0, xpToNextLevel: 100 }, hasPosted: false, journeyLog: [] };
                        document.getElementById('reg-step-1').classList.add('hidden');
                        document.getElementById('reg-step-2').classList.remove('hidden');
                    } else {
                        alert('Please fill out all fields with a valid email.');
                    }
                };

                document.getElementById('reg-step2-next').onclick = () => {
                    document.getElementById('reg-step-2').classList.add('hidden');
                    document.getElementById('reg-step-3').classList.remove('hidden');
                    setTimeout(() => { 
                         const path = currentUser.role === 'learner' ? '#playground' : '#forum';
                         window.history.pushState({}, '', path);
                         navigate();
                    }, 2000);
                };
            }
            
            function initializeForumRegistrationPage() {
                let selectedRole = '';
                let selectedAvatar = avatars[0];
                const avatarContainer = document.getElementById('forum-reg-avatar-selection');
                avatarContainer.innerHTML = avatars.map(av => `<img src="${av}" class="w-16 h-16 rounded-full cursor-pointer hover:ring-2 ring-violet-500" data-avatar="${av}">`).join('');
                avatarContainer.querySelector('img').classList.add('ring-2', 'ring-violet-500');

                document.querySelectorAll('#forum-reg-form .role-btn').forEach(btn => {
                    btn.onclick = () => {
                        document.querySelector('#forum-reg-form .role-btn.bg-violet-600')?.classList.remove('bg-violet-600', 'text-white');
                        btn.classList.add('bg-violet-600', 'text-white');
                        selectedRole = btn.dataset.role;
                        document.getElementById('forum-age-selector').classList.toggle('hidden', selectedRole !== 'learner');
                    }
                });

                avatarContainer.querySelectorAll('img').forEach(img => {
                    img.onclick = () => {
                        avatarContainer.querySelector('.ring-2')?.classList.remove('ring-2', 'ring-violet-500');
                        img.classList.add('ring-2', 'ring-violet-500');
                        selectedAvatar = img.dataset.avatar;
                    };
                });

                document.getElementById('forum-reg-submit').onclick = () => {
                    const username = document.getElementById('forum-reg-username').value.trim();
                    const email = document.getElementById('forum-reg-email').value.trim();
                    const age = document.getElementById('forum-reg-age').value;
                    if (!selectedRole) { alert('Please select if you are a Learner or a Parent.'); return; }
                    if (username && email && email.includes('@')) {
                        currentUser = { username, email, role: selectedRole, age: selectedRole === 'learner' ? parseInt(age) : null, profile: { about: '', avatar: selectedAvatar, rank: 'New Learner', xp: 0, xpToNextLevel: 100 }, hasPosted: false, journeyLog: [] };
                        alert('Welcome to the community! You are now logged in.');
                        window.history.pushState({}, '', '#forum');
                        navigate();
                    } else {
                        alert('Please fill out all fields with a valid email.');
                    }
                };
            }

            // --- Playground Logic ---
            function initializePlayground() {
                const container = document.getElementById('playground-view-container');
                if (!currentUser || currentUser.role !== 'learner') {
                    // REVISED: Improved alignment and structure for the non-learner view.
                    container.innerHTML = `
                    <div class="text-center max-w-2xl mx-auto">
                        <h2 class="text-3xl font-bold">Welcome, explorer!</h2>
                        <p class="mt-4 text-slate-500">Please register as a learner to access the playground.</p>
                        <a href="#registration" class="nav-link mt-6 btn-squish inline-block bg-violet-600 text-white font-bold px-6 py-3 rounded-full">Join the fun!</a>
                    </div>`;
                    return;
                }
                renderPlaygroundDashboard();
                renderPlaygroundView('modules');
                attachPlaygroundNavListeners();
            }
            
            function renderPlaygroundDashboard() {
                const container = document.getElementById('playground-dashboard-profile');
                if (!container || !currentUser) return;
                const { rank, xp, xpToNextLevel } = currentUser.profile;
                const progressPercent = (xp / xpToNextLevel) * 100;
                const rankData = ranks.find(r => r.name === rank) || ranks[0];
                const starsHTML = '⭐'.repeat(rankData.stars);

                container.innerHTML = `
                    <img src="${currentUser.profile.avatar}" class="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-white shadow-lg">
                    <h3 class="font-bold text-xl">${currentUser.username}</h3>
                    <p class="text-violet-600 font-semibold">${rank} <span class="text-yellow-400">${starsHTML}</span></p>
                    <div class="mt-4">
                        <div class="bg-slate-300 w-full h-4 rounded-full overflow-hidden">
                            <div class="bg-green-500 h-full rounded-full" style="width: ${progressPercent}%"></div>
                        </div>
                        <p class="text-sm text-slate-500 mt-1">${xp} / ${xpToNextLevel} XP</p>
                    </div>
                `;
            }

            function renderPlaygroundView(viewName) {
                const container = document.getElementById('playground-view-container');
                if (!container) return;
                container.innerHTML = '';
                let viewHTML = '';

                switch(viewName) {
                    case 'my-journey': viewHTML = getMyJourneyViewHTML(); break;
                    case 'achievements': viewHTML = getAchievementsViewHTML(); break;
                    default: viewHTML = getPlaygroundModulesHTML();
                }
                container.innerHTML = viewHTML;

                if(viewName === 'my-journey') {
                    attachMyJourneyListeners();
                }
            }
            
            function getPlaygroundModulesHTML() {
                let ageBracket = '3-5';
                if (currentUser.age >= 6 && currentUser.age <= 8) ageBracket = '6-8';
                if (currentUser.age >= 9 && currentUser.age <= 12) ageBracket = '9-12';

                // REVISED: Improved alignment with text-center and max-width.
                return `
                    <div class="text-center">
                        <h1 class="text-4xl font-bold mb-2">Hey ${currentUser.username}, since you are age ${ageBracket}, here are the best things for you.</h1>
                        <p class="text-xl text-slate-500 mb-10 max-w-3xl mx-auto">Let's start a new adventure!</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="bg-white p-6 rounded-2xl shadow-lg border text-left"><h3 class="font-bold text-lg">Firefly Forest</h3><p class="text-sm mt-2">Practice your focus skills!</p></div>
                        <div class="bg-white p-6 rounded-2xl shadow-lg border text-left"><h3 class="font-bold text-lg">Cosmic Chef</h3><p class="text-sm mt-2">Test your amazing memory.</p></div>
                        <div class="bg-white p-6 rounded-2xl shadow-lg border text-left"><h3 class="font-bold text-lg">Shape Shifter's Workshop</h3><p class="text-sm mt-2">A fun game about switching rules.</p></div>
                    </div>
                `;
            }
            
            function getMyJourneyViewHTML() {
                return `
                    <div class="text-center">
                        <h1 class="text-4xl font-bold mb-2">My journey</h1>
                        <p class="text-xl text-slate-500 max-w-2xl mx-auto">Here you can grow your superpowers by thinking back on what you have done... <span class="block font-bold text-violet-600 text-2xl mt-2">SO YOU CAN BECOME YOUR BEST SELF!</span></p>
                    </div>
                    <div id="journey-module" class="mt-12 max-w-3xl mx-auto bg-slate-100 p-8 rounded-2xl">
                        <div id="journey-prompt-selection">
                            <p class="text-lg font-semibold text-center mb-4">Questions that you should think about...</p>
                            <div id="journey-prompt-display" class="bg-white p-4 rounded-lg text-center font-bold text-xl min-h-[6rem] flex items-center justify-center"></div>
                            <div class="flex gap-4 mt-4">
                                <button id="new-prompt-btn" class="btn-squish w-full bg-slate-200 py-2 rounded-full font-semibold">New question</button>
                                <button id="lock-in-btn" class="btn-squish w-full bg-violet-600 text-white py-2 rounded-full font-bold">Lock in!</button>
                            </div>
                        </div>
                        <div id="journey-writing-area" class="hidden">
                            <h2 id="locked-in-title" class="text-2xl font-bold mb-4 text-center"></h2>
                            <textarea id="journey-entry" class="w-full h-64 p-4 rounded-lg border border-slate-300" placeholder="Start writing your adventure here..."></textarea>
                            <button id="journey-done-btn" class="btn-squish w-full mt-4 bg-green-500 text-white font-bold py-3 rounded-full">I'm done!</button>
                        </div>
                    </div>
                    <div id="journey-log" class="mt-12 max-w-3xl mx-auto">
                        <h2 class="text-2xl font-bold mb-4">My journey log</h2>
                        <div id="journey-log-entries" class="space-y-4"></div>
                    </div>
                `;
            }

            function getAchievementsViewHTML() {
                let achievementsHTML = currentUser.journeyLog.map(entry => `
                    <div class="bg-white p-4 rounded-lg border border-slate-200">
                        <p class="text-xs text-slate-400">${entry.date}</p>
                        <h4 class="font-bold text-lg">${entry.title}</h4>
                    </div>
                `).join('');

                if (!achievementsHTML) {
                    achievementsHTML = '<p class="text-slate-500">You haven\'t completed any journey entries yet. Go write one to earn XP!</p>';
                }

                return `
                    <h1 class="text-4xl font-bold mb-2">My achievements</h1>
                    <p class="text-xl text-slate-500 mb-10">Look at all the amazing things you've done!</p>
                    <div class="space-y-4">${achievementsHTML}</div>
                `;
            }

            function attachPlaygroundNavListeners() {
                const navContainer = document.getElementById('playground-nav');
                navContainer.innerHTML = `
                    <a href="#" data-view="modules" class="playground-nav-link block font-semibold p-3 rounded-lg bg-violet-600 text-white">Learning modules</a>
                    <a href="#" data-view="my-journey" class="playground-nav-link block font-semibold p-3 rounded-lg hover:bg-slate-200">My journey</a>
                    <a href="#" data-view="achievements" class="playground-nav-link block font-semibold p-3 rounded-lg hover:bg-slate-200">My achievements</a>
                `;
                document.querySelectorAll('.playground-nav-link').forEach(link => {
                    link.onclick = (e) => {
                        e.preventDefault();
                        document.querySelector('.playground-nav-link.bg-violet-600')?.classList.remove('bg-violet-600', 'text-white');
                        link.classList.add('bg-violet-600', 'text-white');
                        renderPlaygroundView(link.dataset.view);
                    }
                });
            }
            
            function attachMyJourneyListeners() {
                const promptEl = document.getElementById('journey-prompt-display');
                let currentPrompt = journeyPrompts[0];
                promptEl.textContent = currentPrompt;

                document.getElementById('new-prompt-btn').onclick = () => {
                    currentPrompt = journeyPrompts[Math.floor(Math.random() * journeyPrompts.length)];
                    promptEl.textContent = currentPrompt;
                };

                document.getElementById('lock-in-btn').onclick = () => {
                    document.getElementById('journey-prompt-selection').classList.add('hidden');
                    const writingArea = document.getElementById('journey-writing-area');
                    writingArea.classList.remove('hidden');
                    writingArea.querySelector('#locked-in-title').textContent = currentPrompt;
                };

                document.getElementById('journey-done-btn').onclick = () => {
                    const entryText = document.getElementById('journey-entry').value.trim();
                    const title = document.getElementById('locked-in-title').textContent;
                    if (entryText) {
                        const newLogEntry = {
                            title: title,
                            content: entryText,
                            date: new Date().toLocaleDateString()
                        };
                        currentUser.journeyLog.unshift(newLogEntry);
                        addXp(50); 
                        alert('Amazing work! Your journey has been logged and you earned 50 XP!');
                        renderPlaygroundView('my-journey');
                    }
                };
                
                const logContainer = document.getElementById('journey-log-entries');
                if (currentUser.journeyLog.length > 0) {
                    logContainer.innerHTML = currentUser.journeyLog.map(entry => `
                        <div class="bg-white p-4 rounded-lg border">
                            <p class="text-xs text-slate-400">${entry.date}</p>
                            <h4 class="font-bold text-lg">${entry.title}</h4>
                            <p class="mt-2 whitespace-pre-wrap">${entry.content}</p>
                        </div>
                    `).join('');
                } else {
                    logContainer.innerHTML = '<p class="text-slate-500 text-center">Your logged journey entries will appear here!</p>';
                }
            }

            function addXp(amount) {
                if (!currentUser) return;
                currentUser.profile.xp += amount;
                const currentRankIndex = ranks.findIndex(r => r.name === currentUser.profile.rank);
                const nextRank = ranks[currentRankIndex + 1];

                if (nextRank && currentUser.profile.xp >= currentUser.profile.xpToNextLevel) {
                    const oldRankIndex = ranks.findIndex(r => r.name === currentUser.profile.rank) || 0;
                    currentUser.profile.rank = nextRank.name;
                    currentUser.profile.xp -= ranks[oldRankIndex].xpThreshold;
                    currentUser.profile.xpToNextLevel = ranks[currentRankIndex + 2]?.xpThreshold || currentUser.profile.xpToNextLevel;
                    alert(`Congratulations! You've ranked up to ${nextRank.name}!`);
                }
                renderPlaygroundDashboard();
            }

            // --- Forum Logic ---
            function initializeForum() {
                renderForumView('main');
                attachSidePanelListeners();
            }

            function renderForumView(viewName) {
                const container = document.getElementById('forum-view-container');
                if (!container) return;
                container.innerHTML = '';
                let viewHTML = '';

                switch(viewName) {
                    case 'profile': viewHTML = getProfileViewHTML(); break;
                    case 'friends': viewHTML = getFriendsViewHTML(); break;
                    case 'parent-dashboard': viewHTML = getParentDashboardHTML(); break;
                    default: viewHTML = getMainForumViewHTML();
                }
                container.innerHTML = viewHTML;

                if (viewName === 'main') {
                    renderChannels();
                    renderPosts();
                    updateAuthView();
                    attachPostFormListener();
                } else if (viewName === 'profile') {
                    attachProfileListeners();
                } else if (viewName === 'parent-dashboard') {
                    attachParentDashboardListeners();
                }
            }

            function attachSidePanelListeners() {
                const toggleBtn = document.getElementById('menu-toggle-btn');
                const panelContainer = document.getElementById('side-panel-container');
                const contentArea = document.getElementById('forum-content-area');
                
                function togglePanel(forceState) {
                    const isOpen = panelContainer.classList.contains('open');
                    const shouldOpen = typeof forceState === 'boolean' ? forceState : !isOpen;

                    if (shouldOpen) {
                        panelContainer.classList.remove('closed');
                        panelContainer.classList.add('open');
                        contentArea.style.marginRight = '256px';
                        toggleBtn.classList.add('hidden-by-panel');
                    } else {
                        panelContainer.classList.remove('open');
                        panelContainer.classList.add('closed');
                        contentArea.style.marginRight = '0';
                        toggleBtn.classList.remove('hidden-by-panel');
                    }
                }
                
                toggleBtn?.addEventListener('click', () => togglePanel(true));
                panelContainer?.addEventListener('mouseleave', () => togglePanel(false));
                
                const parentDashboardLink = document.getElementById('side-panel-parent-dashboard');
                if(currentUser && currentUser.role === 'parent') {
                    parentDashboardLink?.classList.remove('hidden');
                } else {
                    parentDashboardLink?.classList.add('hidden');
                }

                document.getElementById('side-panel-home')?.addEventListener('click', (e) => { e.preventDefault(); renderForumView('main'); togglePanel(false); });
                document.getElementById('side-panel-profile')?.addEventListener('click', (e) => { e.preventDefault(); if(!currentUser) { showLoginRequiredModal(); return; } renderForumView('profile'); togglePanel(false); });
                document.getElementById('side-panel-parent-dashboard')?.addEventListener('click', (e) => { e.preventDefault(); if(!currentUser) { showLoginRequiredModal(); return; } renderForumView('parent-dashboard'); togglePanel(false); });
                document.getElementById('side-panel-friends')?.addEventListener('click', (e) => { e.preventDefault(); if(!currentUser) { showLoginRequiredModal(); return; } renderForumView('friends'); togglePanel(false); });
            }

            function getMainForumViewHTML() {
                // REVISED: Using CSS Grid for more stable alignment.
                return `
                    <div class="text-center mb-12">
                        <h1 class="text-4xl md:text-6xl font-bold text-slate-900 tracking-tight">Join the collective.</h1>
                        <p class="mt-4 text-xl max-w-3xl mx-auto text-slate-500">This is your space to share breakthroughs, ask for advice, and grow with a family that gets it. The more you share, the more everyone learns!</p>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-4 lg:gap-8">
                        <aside class="lg:col-span-1">
                            <div class="sticky top-24">
                                <div id="auth-container" class="bg-slate-50 p-6 rounded-2xl border border-slate-200 mb-6 text-center"></div>
                                <div class="bg-slate-50 p-4 rounded-2xl border border-slate-200">
                                    <h3 class="font-bold text-xl mb-4 text-violet-600 px-2">Channels</h3>
                                    <ul id="channel-list" class="space-y-1"></ul>
                                    ${currentUser ? `<div class="mt-4 px-2"><input id="new-channel-input" class="w-full p-2 rounded-lg border" placeholder="Create a new channel..."><button id="new-channel-btn" class="btn-squish w-full mt-2 bg-emerald-500 text-white font-bold py-2 rounded-full">Create</button></div>` : ''}
                                </div>
                            </div>
                        </aside>
                        <main class="lg:col-span-3 mt-8 lg:mt-0">
                            <div id="new-post-form" class="bg-slate-100 p-6 rounded-2xl border border-slate-200 mb-8 hidden">
                                <h2 class="text-2xl font-bold mb-4">Share your spark in <span id="current-channel-name" class="text-violet-600"></span></h2>
                                <div class="space-y-4"><input id="forum-title" type="text" placeholder="A brilliant title..." class="w-full p-3 rounded-lg border border-slate-300"><textarea id="forum-content" placeholder="Share your thoughts..." rows="4" class="w-full p-3 rounded-lg border border-slate-300"></textarea><button id="forum-submit" class="btn-squish bg-violet-600 text-white font-bold px-8 py-3 rounded-full">Launch post</button></div>
                            </div>
                            <div id="forum-posts-container" class="space-y-6"></div>
                        </main>
                    </div>
                `;
            }

            function getProfileViewHTML() {
                 const rankData = ranks.find(r=>r.name===currentUser.profile.rank) || ranks[0];
                 const progressPercent = (currentUser.profile.xp / currentUser.profile.xpToNextLevel) * 100;
                 return `
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-4xl font-bold text-center mb-12">Your hero profile</h1>
                        <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200 grid md:grid-cols-3 gap-8">
                            <div class="md:col-span-1 text-center">
                                <img id="profile-avatar-img" src="${currentUser.profile.avatar}" class="w-32 h-32 rounded-full mx-auto mb-4 bg-slate-200 border-4 border-white shadow-lg">
                                <input id="profile-username" class="text-2xl font-bold text-center w-full bg-transparent" value="${currentUser.username}">
                                <p class="text-slate-500">${currentUser.email}</p>
                                <div class="mt-4 text-center">
                                    <p class="font-bold text-violet-600">${currentUser.profile.rank} <span class="text-yellow-400">${'⭐'.repeat(rankData.stars)}</span></p>
                                    <div class="bg-slate-300 w-full h-4 rounded-full overflow-hidden mt-1"><div class="bg-green-500 h-full rounded-full" style="width: ${progressPercent}%"></div></div>
                                    <p class="text-sm text-slate-500 mt-1">${currentUser.profile.xp} / ${currentUser.profile.xpToNextLevel} XP</p>
                                </div>
                                <h4 class="font-bold mt-6 mb-2">Choose your hero avatar</h4>
                                <div id="avatar-selection" class="flex flex-wrap gap-2 justify-center">${avatars.map(av => `<img src="${av}" class="w-12 h-12 rounded-full cursor-pointer hover:ring-2 ring-violet-500" data-avatar="${av}">`).join('')}</div>
                            </div>
                            <div class="md:col-span-2">
                                <h3 class="text-xl font-bold mb-2">Your story</h3>
                                <textarea id="profile-about-me" class="w-full p-3 rounded-lg border border-slate-300" rows="4" placeholder="Tell the community about your adventures...">${currentUser.profile.about}</textarea>
                                <button id="save-profile-btn" class="btn-squish mt-4 bg-violet-600 text-white font-bold px-6 py-2 rounded-full">Save my profile</button>
                                <h3 class="text-xl font-bold mt-8 mb-4">Your posts</h3>
                                <div class="space-y-4 max-h-60 overflow-y-auto pr-2">${posts.filter(p => p.author === currentUser.username).map(p => `<div class="bg-white p-4 rounded-lg border"><strong>${p.title}</strong> in <em>${p.channel}</em></div>`).join('') || '<p class="text-slate-500">No sparks shared yet.</p>'}</div>
                            </div>
                        </div>
                    </div>`;
            }
            
            function getFriendsViewHTML() { return `<div class="text-center"><h1 class="text-4xl font-bold">Your friends</h1><p class="mt-4 text-slate-500">This feature is coming soon!</p></div>`; }

            function getParentDashboardHTML() {
                const childName = "Leo"; 
                return `
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-4xl font-bold text-center mb-2">Parent dashboard</h1>
                        <p class="text-center text-slate-500 mb-12">Insights into your child's journey.</p>
                        <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
                            <h2 class="text-2xl font-bold text-violet-600">Gemini AI-powered summary for ${childName}</h2>
                            <p class="text-slate-500 mt-2 mb-4">Get a positive, actionable summary of your child's progress, generated by our Cognitive Companion AI. We focus on growth and effort, not just scores.</p>
                            
                            <div id="ai-summary-container" class="bg-violet-100 p-6 rounded-lg min-h-[10rem] flex items-center justify-center">
                                <button id="generate-summary-btn" class="btn-squish bg-violet-600 text-white font-bold px-8 py-3 rounded-full">Generate weekly summary</button>
                            </div>

                            <div class="mt-8">
                                <h3 class="text-xl font-bold">How it works</h3>
                                <p class="text-slate-600 mt-2">When you click the button, we securely send anonymized game data to the Google Gemini API with a specialized prompt. The AI analyzes patterns in Working Memory, Inhibitory Control, and Cognitive Flexibility games to provide a helpful, easy-to-understand summary. We NEVER show raw scores or percentiles here.</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            function attachParentDashboardListeners() {
                const generateBtn = document.getElementById('generate-summary-btn');
                const summaryContainer = document.getElementById('ai-summary-container');

                generateBtn.onclick = async () => {
                    summaryContainer.innerHTML = `<p class="text-slate-600 animate-pulse">Generating your summary with Gemini AI...</p>`;
                    
                    const childPerformanceData = {
                        'working_memory_games': { 'progress': 'increased max sequence from 4 to 6' },
                        'inhibitory_control_games': { 'impulse_errors': 'decreased by 20%' },
                        'cognitive_flexibility_games': { 'switch_cost_time': 'remains high' }
                    };

                    const geminiApiPrompt = `You are a child development expert providing encouraging feedback. Based on the following raw data for a child named Leo, write a short (2-3 sentences), positive, and actionable summary for his parent. Focus on effort and growth, not scores. Avoid clinical language. Data: ${JSON.stringify(childPerformanceData)}. Frame the area for growth as a fun, upcoming challenge.`;

                    console.log("--- Frontend would send data to backend. Backend would use this prompt for Gemini: ---");
                    console.log(geminiApiPrompt);

                    setTimeout(() => {
                        const simulatedAiResponse = "Leo is showing fantastic growth in his memory and focus skills this week! He's remembering longer patterns in Cosmic Chef, which is brilliant. To continue building his flexible-thinking muscles, we can encourage him to play the Shape Shifter's Workshop next. It's a fun challenge about switching up the rules!";
                        summaryContainer.innerHTML = `<p class="text-lg text-slate-700 text-center">${simulatedAiResponse}</p>`;
                    }, 2000);
                };
            }

            function attachProfileListeners() {
                document.getElementById('save-profile-btn')?.addEventListener('click', () => {
                    currentUser.profile.about = document.getElementById('profile-about-me').value;
                    currentUser.username = document.getElementById('profile-username').value;
                    alert('Profile saved!');
                });
                document.querySelectorAll('#avatar-selection img').forEach(img => {
                    img.addEventListener('click', () => {
                        currentUser.profile.avatar = img.dataset.avatar;
                        document.getElementById('profile-avatar-img').src = img.dataset.avatar;
                    });
                });
            }

            function updateAuthView() {
                const authContainer = document.getElementById('auth-container');
                const newPostForm = document.getElementById('new-post-form');
                if (!authContainer || !newPostForm) return;

                if (currentUser) {
                    authContainer.innerHTML = `<div class="text-center"><img src="${currentUser.profile.avatar}" class="w-20 h-20 rounded-full mx-auto mb-2"><h3 class="font-bold text-lg">${currentUser.username}</h3><p class="text-sm text-slate-500 mb-4">Welcome back!</p><button id="logout-btn" class="btn-squish w-full bg-slate-200 text-slate-700 font-bold py-2 rounded-full">End session</button></div>`;
                    newPostForm.classList.remove('hidden');
                    document.getElementById('logout-btn').onclick = () => { currentUser = null; window.location.reload(); };
                } else {
                    authContainer.innerHTML = `<h3 class="font-bold text-xl mb-2 text-violet-600">Ready for adventure?</h3><p class="text-sm text-slate-500 mb-4">Create an account to post, vote, and make friends!</p><a href="#forum-registration" class="nav-link btn-squish w-full bg-violet-600 text-white font-bold py-3 rounded-full hover:bg-violet-700">Join the fun now!</a>`;
                    newPostForm.classList.add('hidden');
                }
                renderPosts();
            }

            function showLoginRequiredModal() {
                const modal = document.getElementById('login-required-modal');
                if(!modal) return;
                
                modal.classList.add('is-open');
                document.getElementById('login-modal-signin').onclick = () => {
                    modal.classList.remove('is-open');
                    window.location.hash = '#forum-registration';
                };
                 document.getElementById('login-modal-signup').onclick = () => {
                    modal.classList.remove('is-open');
                    window.location.hash = '#forum-registration';
                };
            }

            function attachGlobalFooterListeners() {
                document.querySelectorAll('#tos-link, #privacy-policy-link').forEach(el => {
                    if (el.dataset.listenerAttached) return;
                    el.dataset.listenerAttached = true;
                    el.addEventListener('click', (e) => {
                        e.preventDefault();
                        const type = e.currentTarget.id === 'tos-link' ? 'tos' : 'privacy';
                        showLegalModal(type);
                    });
                });
            }
            
            function initializeHelpPage() {
                 document.getElementById('submit-help-page-link')?.addEventListener('click', (e) => {
                    e.preventDefault();
                    const name = document.getElementById('help-page-name').value;
                    const account = document.getElementById('help-page-account').value;
                    const subject = document.getElementById('help-page-subject').value;
                    const problem = document.getElementById('help-page-problem').value;
                    e.currentTarget.href = `mailto:support@neuraplay.biz?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(`Name: ${name}\nAccount: ${account}\n\nProblem:\n${problem}`)}`;
                    window.location.href = e.currentTarget.href;
                });
            }
            
            function renderChannels() {
                const channelList = document.getElementById('channel-list');
                if (!channelList) return;
                
                const getPopularity = (channel) => posts.reduce((acc, post) => post.channel === channel ? acc + post.votes + post.replies.length : acc, 0);
                const sortedChannels = [...channels].sort((a, b) => getPopularity(b) - getPopularity(a));

                channelList.innerHTML = '';
                sortedChannels.forEach(channel => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = '#';
                    a.textContent = channel;
                    a.className = `block py-2 px-3 rounded-lg transition-colors font-semibold ${currentChannel === channel ? 'bg-violet-600 text-white shadow-md' : 'text-slate-600 hover:bg-slate-200'}`;
                    a.onclick = (e) => { e.preventDefault(); currentChannel = channel; renderChannels(); renderPosts(); };
                    li.appendChild(a);
                    channelList.appendChild(li);
                });

                document.getElementById('new-channel-btn')?.addEventListener('click', () => {
                    const input = document.getElementById('new-channel-input');
                    const newChannelName = input.value.trim();
                    if (newChannelName && !channels.includes(newChannelName)) {
                        channels.push(newChannelName);
                        currentChannel = newChannelName;
                        renderChannels();
                        renderPosts();
                        input.value = '';
                    }
                });
            }

            function renderPosts() {
                const container = document.getElementById('forum-posts-container');
                const channelNameSpan = document.getElementById('current-channel-name');
                if (!container || !channelNameSpan) return;
                channelNameSpan.textContent = currentChannel;
                container.innerHTML = '';
                const filteredPosts = posts.filter(p => p.channel === currentChannel).sort((a, b) => b.votes - a.votes);
                if (filteredPosts.length === 0) {
                    container.innerHTML = `<div class="text-center text-slate-500 p-8 bg-slate-50 rounded-2xl">No sparks in this channel yet. Be the first to ignite a conversation!</div>`;
                    return;
                }
                filteredPosts.forEach(post => container.appendChild(createPostElement(post)));
                attachPostActionListeners();
            }

            function createPostElement(post, isReply = false) {
                const postElement = document.createElement('div');
                postElement.className = `bg-white border border-slate-200 rounded-2xl shadow-sm flex gap-4 ${isReply ? 'p-4 ml-8' : 'p-6'}`;
                postElement.innerHTML = `
                    <div class="flex flex-col items-center space-y-1 text-slate-500 pt-2">
                        <button class="vote-btn p-1 rounded-full hover:bg-green-100 hover:text-green-600" data-id="${post.id}" data-vote="up"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg></button>
                        <span class="font-bold text-lg text-slate-700">${post.votes}</span>
                        <button class="vote-btn p-1 rounded-full hover:bg-red-100 hover:text-red-600" data-id="${post.id}" data-vote="down"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>
                    </div>
                    <div class="flex-grow">
                        ${isReply ? '' : `<p class="text-xs text-violet-600 font-bold">${post.channel}</p><h3 class="font-bold text-xl text-slate-800 mt-1">${post.title}</h3>`}
                        <p class="text-slate-600 mt-2">${post.content}</p>
                        <div class="flex items-center justify-between mt-4 text-sm text-slate-400">
                            <div class="flex items-center gap-2">
                                <img src="${post.avatar}" class="w-6 h-6 rounded-full bg-slate-200">
                                <span>Posted by: <strong>${post.author}</strong></span>
                            </div>
                            <div class="flex items-center gap-4">
                                <button data-id="${post.id}" class="reply-btn font-semibold hover:text-violet-600">Reply</button>
                                ${currentUser && currentUser.username !== post.author ? `<button data-author="${post.author}" class="add-friend-btn font-semibold text-violet-600 hover:underline">Add friend</button>` : ''}
                                <button data-id="${post.id}" class="report-btn font-semibold hover:text-red-600 text-xs">Report</button>
                            </div>
                        </div>
                        <div class="reply-form-container mt-4 hidden"></div>
                        <div class="replies-container mt-4 space-y-4"></div>
                    </div>`;
                
                const repliesContainer = postElement.querySelector('.replies-container');
                post.replies.forEach(reply => repliesContainer.appendChild(createPostElement(reply, true)));

                return postElement;
            }
            
            function attachPostActionListeners() {
                document.querySelectorAll('.vote-btn, .reply-btn, .add-friend-btn, .report-btn').forEach(btn => {
                    btn.addEventListener('click', handlePostAction);
                });
            }

            function handlePostAction(e) {
                if (!currentUser) { showLoginRequiredModal(); return; }
                const target = e.currentTarget;
                const id = parseInt(target.dataset.id || target.closest('[data-id]')?.dataset.id);
                
                if (target.classList.contains('vote-btn')) {
                    const post = findPost(id);
                    if (post) {
                        target.dataset.vote === 'up' ? post.votes++ : post.votes--;
                        renderPosts();
                    }
                } else if (target.classList.contains('reply-btn')) {
                    const formContainer = target.closest('.flex-grow').querySelector('.reply-form-container');
                    formContainer.classList.toggle('hidden');
                    formContainer.innerHTML = `<textarea class="w-full p-2 rounded-lg border" placeholder="Replying to @${findPost(id).author}..."></textarea><button data-id="${id}" class="submit-reply-btn btn-squish mt-2 bg-violet-500 text-white font-bold px-4 py-1 rounded-full">Reply</button>`;
                    formContainer.querySelector('.submit-reply-btn').onclick = submitReply;
                } else if (target.classList.contains('add-friend-btn')) {
                    alert(`Friend request sent to ${target.dataset.author}! (Demo)`);
                } else if (target.classList.contains('report-btn')) {
                    alert('Thank you for your report. Our team will review this post.');
                }
            }
            
            function submitReply(e) {
                const parentId = parseInt(e.currentTarget.dataset.id);
                const parentPost = findPost(parentId);
                const textarea = e.currentTarget.previousElementSibling;
                const content = textarea.value.trim();
                if (content && parentPost) {
                    const newReply = { id: Date.now(), parentId, author: currentUser.username, avatar: currentUser.profile.avatar, votes: 1, content, replies: [] };
                    parentPost.replies.unshift(newReply);
                    renderPosts();
                }
            }

            function findPost(id, searchPosts = posts) {
                for (const post of searchPosts) {
                    if (post.id === id) return post;
                    const foundInReply = findPost(id, post.replies);
                    if (foundInReply) return foundInReply;
                }
                return null;
            }
            
            function attachPostFormListener() {
                document.getElementById('forum-submit')?.addEventListener('click', () => {
                    if (!currentUser) { showLoginRequiredModal(); return; }
                    
                    if (!currentUser.hasPosted) {
                        const rulesModal = document.getElementById('rules-modal');
                        rulesModal.classList.add('is-open');
                        rulesModal.firstElementChild.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        const agreeCheckbox = rulesModal.querySelector('#rules-agree-checkbox');
                        const closeBtn = rulesModal.querySelector('#close-rules-btn');
                        agreeCheckbox.onchange = () => { closeBtn.disabled = !agreeCheckbox.checked; };
                        closeBtn.onclick = () => {
                            if (agreeCheckbox.checked) {
                                rulesModal.classList.remove('is-open');
                                currentUser.hasPosted = true;
                                document.getElementById('forum-submit').click();
                            }
                        };
                        return;
                    }

                    const title = document.getElementById('forum-title').value.trim();
                    const content = document.getElementById('forum-content').value.trim();
                    if (!title || !content) { alert('Please fill out all fields.'); return; }
                    const newPost = { id: Date.now(), channel: currentChannel, title, content, author: currentUser.username, votes: 1, avatar: currentUser.profile.avatar, replies: [] };
                    posts.unshift(newPost);
                    renderPosts();
                    document.getElementById('forum-title').value = '';
                    document.getElementById('forum-content').value = '';
                });
            }

            function showLegalModal(type) {
                const modalId = type === 'tos' ? 'tos-modal' : 'privacy-modal';
                const modal = document.getElementById(modalId);
                if (!modal) return;
                
                const content = type === 'tos' ? getTOSContent() : getPrivacyContent();
                modal.innerHTML = `
                    <div class="bg-white max-w-3xl w-full rounded-2xl p-8 shadow-2xl">
                        <h2 class="text-2xl font-bold mb-4">${type === 'tos' ? 'Terms of service' : 'Privacy policy'}</h2>
                        <div class="text-slate-600 space-y-3 max-h-[70vh] overflow-y-auto pr-4">${content}</div>
                        <button class="close-legal-btn btn-squish mt-6 w-full bg-violet-600 text-white font-bold py-2 rounded-full">Close</button>
                    </div>`;

                modal.classList.add('is-open');
                modal.firstElementChild.scrollIntoView({ behavior: 'smooth', block: 'center' });
                modal.querySelector('.close-legal-btn').onclick = () => modal.classList.remove('is-open');
            }

            function getTOSContent() { return `<h3 class="font-bold">1. Acceptance of terms</h3><p>By accessing or using Neuraplay ("the Service"), you agree to be bound by these Terms of Service. This agreement governs your use of our software, which is licensed, not sold, to you.</p><h3 class="font-bold mt-4">2. License and distribution</h3><p>Neuraplay grants you a limited, non-exclusive, non-transferable, revocable license to access and use the Service for personal, non-commercial purposes. You may NOT copy, distribute, resell, or sublicense the Software or any part of it. Unauthorized use or distribution is a breach of this agreement.</p><h3 class="font-bold mt-4">3. User conduct and forum</h3><p>You are solely responsible for your conduct and any data, text, files, information, usernames, images, graphics, photos, profiles, audio and video clips, sounds, musical works, works of authorship, applications, links and other content or materials (collectively, "Content") that you submit, post or display on or via the Service. Neuraplay is not responsible for the conduct of its users or the content they post. We reserve the right to remove any content deemed inappropriate without notice.</p><h3 class="font-bold mt-4">4. Limitation of liability</h3><p>The Service is provided "AS IS." While our content is informed by neuropsychological and clinical professionals, it is not a substitute for medical advice. In no event shall Neuraplay be liable for any direct, indirect, or consequential damages arising from your use of the Service or from interactions within the community forum.</p><h3 class="font-bold mt-4">5. Subscriptions and refunds</h3><p>Access to premium features of the Service requires a paid subscription. Subscriptions are billed on a recurring basis. We offer a 14-day money-back guarantee on all initial subscription purchases. If you are not satisfied, you may request a full refund within 14 days of your first payment.</p>`; }
            function getPrivacyContent() { return `<h3 class="font-bold">Our commitment to your privacy</h3><p>Neuraplay holds your privacy to the highest GDPR standards. We are committed to protecting your data and being transparent about how we use it. This policy outlines our practices.</p><h3 class="font-bold mt-4">1. Data we collect</h3><p><strong>Account information:</strong> When you register, we collect your username, email address, chosen avatar, and role (Parent/Learner). If you are a Learner, we also collect your age group. This is used to personalize your experience and for communication.</p><p><strong>Usage data:</strong> We collect anonymized data on how you interact with the games and features to improve our service and the Synaptic AI™. This data is never linked to your personal identity.</p><p><strong>Forum content:</strong> Content you voluntarily post in the community forum is publicly visible to other members.</p><h3 class="font-bold mt-4">2. How we use your data</h3><p>Your data is used to operate, maintain, and improve Neuraplay. We use it to personalize your learning journey, provide customer support, and protect the security of our platform. We will never sell your personal data to third parties.</p><h3 class="font-bold mt-4">3. Your rights (GDPR)</h3><p>You have the right to access, correct, or delete your personal data at any time. You can manage your profile information directly from your user dashboard. For full data deletion requests, please contact our support team.</p><h3 class="font-bold mt-4">4. Data security</h3><p>We implement industry-standard security measures to protect your information from unauthorized access, alteration, or disclosure.</p>`; }
        });
    </script>
</body>
</html>